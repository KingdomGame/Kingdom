Техническая документация
========================

Проект представляет из себя Symfony2 приложение, работающее в связке с node.js вебсокет-сервером по модели publisher-subscriber, где каждому клиенту создается свой вебсокет-канал.

## Используемые технологии
* PHP 5.5
* MySQL 5.5
* jQuery 2.1
* Node.js 0.10.25
* Redis 2.8.4 [команды](http://redis.io/commands)
* Docker 1.0 [руководство](http://docs.docker.com/mac/started/)
* Symfony 2.7 [документация](https://symfony.com/doc/current/index.html)

## Ход работы приложения

#### Подключение
* Запуск вебсервера и серверов баз данных MySQL и redis
* Заупск серверов на Node.js: вебсокет роутер, обработчик команд и сервис событий
* Клиент запрашивает страницу в браузере
* PHP сервер с помощью симфони производит аутентификацию пользователя
* PHP производит запись в redis параметров пользователя и id его сессии
* PHP отдает пользователю страницу с javascript-клиентом
* Javascript-клиент соединяется с вебсокет роутером
* Javascript-клиент подключается к личному вебсокет-каналу, содержащему id его сессии
* Javascript-клиент регистрируется через вебсокеты на сервере обработчика команд
* Обработчик команд подключается к личному каналу клиента
* Javascript-клиент вешает коллбэк и слушает результаты от обработчика команд

#### Основной цикл взаимодействия клиента с сервером
* Javascript-клиент посылает игровую коману
* Обработчик команд получает команду и запускает соответствующую симфони-команду
* Симфони команда производит соответствующие расчеты бизнес-логики и отдает json-ответ
* Обработчик команд отправляет json-ответ запросившему в его личный вебсокет-канал
* Javascript-клиент обрабатывает полученный результат, отрисовывает данные в браузере
